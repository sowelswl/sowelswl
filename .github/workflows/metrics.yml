name: Generate GitHub Metrics
on:
  schedule:
    - cron: "0 0 * * *"  # æ¯å¤©æ›´æ–°
  push:
    branches: [ main ]
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  github-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      actions: read
      pages: write
      id-token: write
    steps:
      - name: Generate Metrics with Private Repositories
        uses: lowlighter/metrics@latest
        with:
          filename: metrics.svg
          token: ${{ secrets.METRICS_TOKEN }}
          committer_token: ${{ secrets.GITHUB_TOKEN }}
          user: sowelswl
          base: "header, activity, community, repositories, metadata"
          config_timezone: Asia/Shanghai
          
          # ğŸ“… è´¡çŒ®æ—¥å†é…ç½®ï¼ˆä¸¤ç§æ ·å¼ï¼‰
          plugin_isocalendar: yes
          plugin_isocalendar_duration: full-year
          plugin_calendar: yes
          plugin_calendar_limit: 2  # æ˜¾ç¤ºæœ€è¿‘2å¹´
          
          # ğŸ¯ ç¼–ç¨‹ä¹ æƒ¯åˆ†æ
          plugin_habits: yes
          plugin_habits_from: 300  # åˆ†ææ›´å¤šäº‹ä»¶æé«˜å‡†ç¡®æ€§
          plugin_habits_days: 21   # åˆ†ææœ€è¿‘21å¤©
          plugin_habits_facts: yes # æ˜¾ç¤ºæœ‰è¶£çš„ç¼–ç¨‹äº‹å®
          plugin_habits_charts: yes # ç”Ÿæˆæ´»åŠ¨å›¾è¡¨
          plugin_habits_charts_type: classic # ç»å…¸å›¾è¡¨æ ·å¼
          plugin_habits_trim: yes  # ä¿®å‰ªæœªä½¿ç”¨çš„æ—¶é—´
          plugin_habits_languages_limit: 6 # é™åˆ¶æ˜¾ç¤º6ç§è¯­è¨€
          plugin_habits_languages_threshold: 1% # 1%ä»¥ä¸Šæ‰æ˜¾ç¤º
          
          # ğŸ’» ç¼–ç¨‹è¯­è¨€ç»Ÿè®¡
          plugin_languages: yes
          plugin_languages_limit: 8  # æ˜¾ç¤ºå‰8ç§è¯­è¨€
          plugin_languages_threshold: 1%  # 1%ä»¥ä¸Šæ‰æ˜¾ç¤º
          plugin_languages_other: yes  # å…¶ä»–è¯­è¨€å½’ç±»åˆ°"Other"
          plugin_languages_colors: rainbow  # å½©è™¹é…è‰²
          plugin_languages_sections: most-used, recently-used  # æ˜¾ç¤ºå¸¸ç”¨å’Œæœ€è¿‘ä½¿ç”¨
          plugin_languages_indepth: yes  # æ·±åº¦åˆ†æä»“åº“
          plugin_languages_categories: programming  # åªæ˜¾ç¤ºç¼–ç¨‹è¯­è¨€
          
          # ğŸ“Š æ´»åŠ¨é…ç½®
          plugin_activity: yes
          plugin_activity_limit: 5
          plugin_activity_days: 30