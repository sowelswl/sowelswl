name: Generate GitHub Metrics
on:
  schedule:
    - cron: "0 */6 * * *"  # æ¯6å°æ—¶æ›´æ–°ä¸€æ¬¡
  push:
    branches: [ main ]
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  generate-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: ğŸ“Š Generate Comprehensive Metrics
        uses: lowlighter/metrics@latest
        with:
          filename: metrics.svg
          token: ${{ secrets.METRICS_TOKEN }}
          committer_token: ${{ secrets.GITHUB_TOKEN }}
          user: sowelswl
          base: "header, community, repositories, metadata"  # 1. ä¸ªäººæ•°æ®
          config_timezone: Asia/Shanghai
          
          # 2. ä¸‰ç»´è´¡çŒ®æ—¥å†é…ç½®
          plugin_isocalendar: yes
          plugin_isocalendar_duration: full-year
          
          # 3. ç¼–ç¨‹ä¹ æƒ¯åˆ†æï¼ˆåŒ…å«è¯­è¨€æ´»åŠ¨ï¼‰
          plugin_habits: yes
          plugin_habits_from: 400  # åˆ†ææ›´å¤šäº‹ä»¶æé«˜å‡†ç¡®æ€§
          plugin_habits_days: 30   # åˆ†ææœ€è¿‘30å¤©
          plugin_habits_facts: yes # æ˜¾ç¤ºæœ‰è¶£çš„ç¼–ç¨‹äº‹å®ï¼ˆåŒ…å«è¯­è¨€ç»Ÿè®¡ï¼‰
          plugin_habits_charts: yes # ç”Ÿæˆæ´»åŠ¨å›¾è¡¨
          plugin_habits_charts_type: classic # ç»å…¸å›¾è¡¨æ ·å¼
          plugin_habits_trim: no   # æ˜¾ç¤ºå®Œæ•´24å°æ—¶ï¼Œæ›´å…¨é¢
          plugin_habits_languages_limit: 8 # æ˜¾ç¤ºæ›´å¤šè¯­è¨€
          plugin_habits_languages_threshold: 0% # æ˜¾ç¤ºæ‰€æœ‰æ£€æµ‹åˆ°çš„è¯­è¨€